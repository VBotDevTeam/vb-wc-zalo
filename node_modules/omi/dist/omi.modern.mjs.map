{"version":3,"file":"omi.modern.mjs","sources":["../src/utils.ts","../src/construct-style-sheets-polyfill.ts","../src/vdom.ts","../src/constants.ts","../src/directive.ts","../src/dom.ts","../src/diff.ts","../src/options.ts","../src/hooks/formAssociated.ts","../src/define.ts","../src/hooks/forwardRef.ts","../src/component.ts","../src/render.ts","../src/class.ts","../src/css-tag.ts","../src/index.ts"],"sourcesContent":["import { ExtendedElement } from './dom'\nimport { ObjectVNode, VNode, Attributes } from './vdom'\nimport './construct-style-sheets-polyfill'\nimport { ComponentHookType, ComponentHooks } from './component'\n\n/**\n * Check if the environment has native custom elements support\n * and apply a shim for the HTMLElement constructor if needed.\n */\n;(function () {\n  const w = typeof window !== 'undefined' ? window : (global as any)\n  if (\n    w.Reflect === undefined ||\n    w.customElements === undefined ||\n    w.customElements.hasOwnProperty('polyfillWrapFlushCallback')\n  ) {\n    return\n  }\n  const BuiltInHTMLElement = w.HTMLElement\n  w.HTMLElement = function HTMLElement() {\n    return Reflect.construct(BuiltInHTMLElement, [], this.constructor)\n  }\n  HTMLElement.prototype = BuiltInHTMLElement.prototype\n  HTMLElement.prototype.constructor = HTMLElement\n  Object.setPrototypeOf(HTMLElement, BuiltInHTMLElement)\n})()\n\n/**\n * Convert a kebab-case string to camelCase.\n * @param str - The kebab-case string to convert.\n * @returns The camelCase version of the input string.\n */\nexport function camelCase(str: string): string {\n  return str.replace(/-(\\w)/g, (_, $1) => $1.toUpperCase())\n}\n\n/**\n * A functional component that renders its children.\n * @param props - The component's props.\n * @returns The component's children.\n */\nexport function Fragment(props: { children: any }): any {\n  return props.children\n}\n\n/**\n * Invoke or update a ref, depending on whether it is a function or object ref.\n * @param ref - The ref to apply.\n * @param value - The value to set or pass to the ref.\n */\nexport function applyRef(\n  ref: ((value: any) => void) | { current: any } | null,\n  value: any,\n): void {\n  if (ref != null) {\n    if (typeof ref == 'function') ref(value)\n    else ref.current = value\n  }\n}\n\n/**\n * Check if the given object is an array.\n * @param obj - The object to check.\n * @returns True if the object is an array, false otherwise.\n */\nexport function isArray(obj: unknown): boolean {\n  return Object.prototype.toString.call(obj) === '[object Array]'\n}\n\nconst hyphenateRE = /\\B([A-Z])/g\n\n/**\n * Convert a camelCase string to kebab-case.\n * @param str - The camelCase string to convert.\n * @returns The kebab-case version of the input string.\n */\nexport function hyphenate(str: string): string {\n  return str.replace(hyphenateRE, '-$1').toLowerCase()\n}\n\n/**\n * Capitalize the first letter of each word in a kebab-case string.\n * @param name - The kebab-case string to capitalize.\n * @returns The capitalized version of the input string.\n */\nexport function capitalize(name: string): string {\n  return name\n    .replace(/\\-(\\w)/g, (_, letter) => letter.toUpperCase())\n    .replace(/^\\S/, (s) => s.toUpperCase())\n}\n\n/**\n * Create a new CSSStyleSheet with the given style.\n * @param style - The CSS style to apply to the new stylesheet.\n * @returns The created CSSStyleSheet.\n */\nexport function createStyleSheet(style: string): CSSStyleSheet {\n  const styleSheet = new CSSStyleSheet()\n  styleSheet.replaceSync(style)\n  return styleSheet\n}\n\n/**\n * Check if two nodes are equivalent.\n * @param node - The DOM Node to compare.\n * @param vnode - The virtual DOM node to compare.\n * @param hydrating - If true, ignores component constructors when comparing.\n * @returns True if the nodes are equivalent, false otherwise.\n */\nexport function isSameNodeType(node: ExtendedElement, vnode: VNode): boolean {\n  if (typeof vnode === 'string' || typeof vnode === 'number') {\n    return node.splitText !== undefined\n  }\n\n  return isNamedNode(node, (vnode as ObjectVNode).nodeName as string)\n}\n\n/**\n * Check if an Element has a given nodeName, case-insensitively.\n * @param node - The DOM Element to inspect the name of.\n * @param nodeName - The unnormalized name to compare against.\n * @returns True if the element has the given nodeName, false otherwise.\n */\nexport function isNamedNode(node: ExtendedElement, nodeName: string): boolean {\n  return (\n    node.normalizedNodeName === nodeName ||\n    node.nodeName.toLowerCase() === nodeName.toLowerCase()\n  )\n}\n\nexport function createRef() {\n  return {}\n}\n\nexport function bind(\n  target: unknown,\n  propertyKey: string,\n  descriptor: PropertyDescriptor,\n) {\n  return {\n    configurable: true,\n    get() {\n      const bound = descriptor.value.bind(this)\n      Object.defineProperty(this, propertyKey, {\n        value: bound,\n        configurable: true,\n        writable: true,\n      })\n      return bound\n    },\n  }\n}\n\nexport function isObject(item: any) {\n  return typeof item === 'object' && !Array.isArray(item) && item !== null\n}\n// 判断对象是否是一个类\nexport function isClass(cls: any): boolean {\n  let result = false\n  if (typeof cls === 'function' && cls.prototype) {\n    try {\n      cls.arguments && cls.caller\n    } catch (e) {\n      result = true\n    }\n  }\n  // 尝试通过正则表达式检查函数字符串形式的开头是否符合类定义的特征\n  const classRegex = /^class\\s/\n  if (classRegex.test(cls.toString())) {\n    return true\n  }\n  return result\n}\n\nexport interface GetClassStaticValueOptions {\n  merge?: 'none' | 'merge' | 'uniqueMerge' // 指定合并策略\n  default?: any // 当不存在时提供一个默认值\n}\n/**\n *\n * 获取继承链上指定字段的值\n * 获取类的静态变量值，会沿继承链向上查找，并能自动合并数组和{}值\n *\n * calss A{\n *     static settings={a:1}\n * }\n * calss A1 extends A{\n *     static settings={b:2}\n * }\n *\n * getStaticFieldValue(new A1(),\"settings\") ==== {a:1,b:2}\n *\n * @param instanceOrClass\n * @param fieldName\n * @param options\n */\nexport function getClassStaticValue(\n  instanceOrClass: object,\n  fieldName: string,\n  options?: GetClassStaticValueOptions,\n) {\n  const opts = Object.assign(\n    {\n      // 是否进行合并,0-代表不合并，也就是不会从原型链中读取，1-使用Object.assign合并,2-使用mergeDeepRigth合并\n      // 对数组,0-不合并，1-合并数组,   2-合并且删除重复项\n      merge: 'uniqueMerge',\n      default: null, // 提供默认值，如果{}和[]，会使用上述的合并策略\n    },\n    options,\n  ) as Required<GetClassStaticValueOptions>\n\n  let proto = isClass(instanceOrClass)\n    ? instanceOrClass\n    : instanceOrClass.constructor\n  let fieldValue = (proto as any)[fieldName]\n  // 0-{}, 1-[], 2-其他类型\n  let valueType = isObject(fieldValue) ? 0 : Array.isArray(fieldValue) ? 1 : 2\n  // 如果不是数组或者{}，则不需要在继承链上进行合并\n  if (opts.merge === 'none' || valueType === 2) {\n    return fieldValue\n  }\n\n  const defaultValue =\n    valueType === 0 ? Object.assign({}, opts.default) : opts.default\n\n  let values = [fieldValue]\n\n  // 依次读取继承链上的所有同名的字段值\n  while (proto) {\n    proto = (proto as any).__proto__\n    if ((proto as any)[fieldName]) {\n      values.push((proto as any)[fieldName])\n    } else {\n      break\n    }\n  }\n  // 进行合并\n  let mergedResult = fieldValue\n  if (valueType === 0) {\n    // Object\n    mergedResult = values.reduce((result, item) => {\n      if (isObject(item)) {\n        // 只能合并字典\n        return opts.merge === 'merge'\n          ? Object.assign({}, defaultValue, item, result)\n          : Object.assign({}, defaultValue, item, result)\n      } else {\n        return result\n      }\n    }, {})\n  } else {\n    // 数组\n    mergedResult = values.reduce((result, item) => {\n      if (Array.isArray(item)) {\n        // 只能合并数组\n        result.push(...item)\n      }\n      return result\n    }, [])\n  }\n  // 删除数组中的重复项\n  if (Array.isArray(mergedResult) && opts.merge === 'uniqueMerge') {\n    mergedResult = Array.from(new Set(mergedResult))\n    // 如果提供defaultValue并且数组成员是一个{},则进行合并\n    if (isObject(defaultValue)) {\n      mergedResult.forEach((value: any, index: number) => {\n        if (isObject(value)) {\n          mergedResult[index] = Object.assign({}, defaultValue, value)\n        }\n      })\n    }\n  }\n  return mergedResult || defaultValue\n}\n\nexport function installHook(target: any, hooks: ComponentHooks) {\n  if (!target.hooks) {\n    target.hooks = {}\n  }\n  Object.entries(hooks).forEach(([key, hook]) => {\n    if (!target.hooks[key]) target.hooks[key] = []\n    target.hooks[key].push(hook)\n  })\n}\n\n/**\n * 执行指定名称的钩子函数\n * @param target  可以是组件实例或者组件类\n */\nexport function executeComponentHooks(\n  target: any,\n  hookName: ComponentHookType,\n) {\n  const hookRegistry = target._hooks\n    ? target._hooks\n    : getClassStaticValue(target, 'hooks') || {}\n  if (!isClass(target)) target._hooks = hookRegistry\n  if (hookName in hookRegistry) {\n    const hooks = hookRegistry[hookName]\n    if (Array.isArray(hooks)) {\n      hooks.forEach((hook) => {\n        try {\n          hook.call(target, target)\n        } catch (e: any) {\n          console.warn(\n            `Error occurred while executing hook function ${\n              isClass(target) ? target.constructor.name : target.name\n            }/${hookName}:`,\n            e,\n          )\n        }\n      })\n    }\n  }\n}\n\n/**\n * 将DOM NodeList转换为Omi VNode\n * @param childNodes DOM NodeList\n * @returns Omi VNode[]\n */\nexport function convertNodeListToVNodes(\n  childNodes: NodeList,\n): Array<VNode | string> {\n  return Array.from(childNodes)\n    .map((node): VNode | string => {\n      // 处理文本节点\n      if (node.nodeType === Node.TEXT_NODE) {\n        return node.textContent || ''\n      }\n      \n      const element = node as Element\n      // 处理元素节点\n      if (element.nodeType === Node.ELEMENT_NODE) {\n        const attributes: Attributes = {\n          ignoreAttrs: false,\n        }\n\n        // 转换元素属性\n        Array.from(element.attributes).forEach((attr) => {\n          attributes[camelCase(attr.name)] = attr.value\n        })\n\n        // 递归处理子节点\n        const children = convertNodeListToVNodes(element.childNodes)\n        return {\n          nodeName: element.tagName.toLowerCase(),\n          attributes,\n          children,\n          key: attributes.key,\n        }\n      }\n      // 其他类型节点（注释等）返回 null\n      return null as any\n    })\n    .filter(Boolean) // 过滤掉 null 值\n}","// @ts-nocheck\n\n;(function () {\n  'use strict'\n\n  if (typeof document === 'undefined' || 'adoptedStyleSheets' in document) {\n    return\n  }\n\n  var hasShadyCss = 'ShadyCSS' in window && !ShadyCSS.nativeShadow\n  var bootstrapper = document.implementation.createHTMLDocument('boot')\n  var closedShadowRootRegistry = new WeakMap()\n  var _DOMException = typeof DOMException === 'object' ? Error : DOMException\n\n  var defineProperty = Object.defineProperty\n  var forEach = Array.prototype.forEach\n  var importPattern = /@import.+?;?$/gm\n  function rejectImports(contents) {\n    var _contents = contents.replace(importPattern, '')\n    if (_contents !== contents) {\n      console.warn(\n        '@import rules are not allowed here. See https://github.com/WICG/construct-stylesheets/issues/119#issuecomment-588352418',\n      )\n    }\n    return _contents.trim()\n  }\n  function clearRules(sheet) {\n    for (var i = 0; i < sheet.cssRules.length; i++) {\n      sheet.deleteRule(0)\n    }\n  }\n  function insertAllRules(from, to) {\n    forEach.call(from.cssRules, function (rule, i) {\n      to.insertRule(rule.cssText, i)\n    })\n  }\n  function isElementConnected(element) {\n    return 'isConnected' in element\n      ? element.isConnected\n      : document.contains(element)\n  }\n  function unique(arr) {\n    return arr.filter(function (value, index) {\n      return arr.indexOf(value) === index\n    })\n  }\n  function diff(arr1, arr2) {\n    return arr1.filter(function (value) {\n      return arr2.indexOf(value) === -1\n    })\n  }\n  function removeNode(node) {\n    node.parentNode.removeChild(node)\n  }\n  function getShadowRoot(element) {\n    return element.shadowRoot || closedShadowRootRegistry.get(element)\n  }\n\n  var cssStyleSheetMethods = [\n    'addImport',\n    'addPageRule',\n    'addRule',\n    'deleteRule',\n    'insertRule',\n    'removeImport',\n    'removeRule',\n  ]\n  var NonConstructedStyleSheet = CSSStyleSheet\n  var nonConstructedProto = NonConstructedStyleSheet.prototype\n  nonConstructedProto.replace = function () {\n    return Promise.reject(\n      new _DOMException(\n        'Can\\'t call replace on non-constructed CSSStyleSheets.',\n      ),\n    )\n  }\n  nonConstructedProto.replaceSync = function () {\n    throw new _DOMException(\n      'Failed to execute \\'replaceSync\\' on \\'CSSStyleSheet\\': Can\\'t call replaceSync on non-constructed CSSStyleSheets.',\n    )\n  }\n  function isCSSStyleSheetInstance(instance) {\n    return typeof instance === 'object'\n      ? proto$2.isPrototypeOf(instance) ||\n          nonConstructedProto.isPrototypeOf(instance)\n      : false\n  }\n  function isNonConstructedStyleSheetInstance(instance) {\n    return typeof instance === 'object'\n      ? nonConstructedProto.isPrototypeOf(instance)\n      : false\n  }\n  var $basicStyleSheet = new WeakMap()\n  var $locations = new WeakMap()\n  var $adoptersByLocation = new WeakMap()\n  function addAdopterLocation(sheet, location) {\n    var adopter = document.createElement('style')\n    $adoptersByLocation.get(sheet).set(location, adopter)\n    $locations.get(sheet).push(location)\n    return adopter\n  }\n  function getAdopterByLocation(sheet, location) {\n    return $adoptersByLocation.get(sheet).get(location)\n  }\n  function removeAdopterLocation(sheet, location) {\n    $adoptersByLocation.get(sheet).delete(location)\n    $locations.set(\n      sheet,\n      $locations.get(sheet).filter(function (_location) {\n        return _location !== location\n      }),\n    )\n  }\n  function restyleAdopter(sheet, adopter) {\n    requestAnimationFrame(function () {\n      clearRules(adopter.sheet)\n      insertAllRules($basicStyleSheet.get(sheet), adopter.sheet)\n    })\n  }\n  function checkInvocationCorrectness(self) {\n    if (!$basicStyleSheet.has(self)) {\n      throw new TypeError('Illegal invocation')\n    }\n  }\n  function ConstructedStyleSheet() {\n    var self = this\n    var style = document.createElement('style')\n    bootstrapper.body.appendChild(style)\n    $basicStyleSheet.set(self, style.sheet)\n    $locations.set(self, [])\n    $adoptersByLocation.set(self, new WeakMap())\n  }\n  var proto$2 = ConstructedStyleSheet.prototype\n  proto$2.replace = function replace(contents) {\n    try {\n      this.replaceSync(contents)\n      return Promise.resolve(this)\n    } catch (e) {\n      return Promise.reject(e)\n    }\n  }\n  proto$2.replaceSync = function replaceSync(contents) {\n    checkInvocationCorrectness(this)\n    if (typeof contents === 'string') {\n      var self_1 = this\n      var style = $basicStyleSheet.get(self_1).ownerNode\n      style.textContent = rejectImports(contents)\n      $basicStyleSheet.set(self_1, style.sheet)\n      $locations.get(self_1).forEach(function (location) {\n        if (location.isConnected()) {\n          restyleAdopter(self_1, getAdopterByLocation(self_1, location))\n        }\n      })\n    }\n  }\n  defineProperty(proto$2, 'cssRules', {\n    configurable: true,\n    enumerable: true,\n    get: function cssRules() {\n      checkInvocationCorrectness(this)\n      return $basicStyleSheet.get(this).cssRules\n    },\n  })\n  cssStyleSheetMethods.forEach(function (method) {\n    proto$2[method] = function () {\n      var self = this\n      checkInvocationCorrectness(self)\n      var args = arguments\n      var basic = $basicStyleSheet.get(self)\n      var locations = $locations.get(self)\n      var result = basic[method].apply(basic, args)\n      locations.forEach(function (location) {\n        if (location.isConnected()) {\n          var sheet = getAdopterByLocation(self, location).sheet\n          sheet[method].apply(sheet, args)\n        }\n      })\n      return result\n    }\n  })\n  defineProperty(ConstructedStyleSheet, Symbol.hasInstance, {\n    configurable: true,\n    value: isCSSStyleSheetInstance,\n  })\n\n  var defaultObserverOptions = {\n    childList: true,\n    subtree: true,\n  }\n  var locations = new WeakMap()\n  function getAssociatedLocation(element) {\n    var location = locations.get(element)\n    if (!location) {\n      location = new Location(element)\n      locations.set(element, location)\n    }\n    return location\n  }\n  function attachAdoptedStyleSheetProperty(constructor) {\n    defineProperty(constructor.prototype, 'adoptedStyleSheets', {\n      configurable: true,\n      enumerable: true,\n      get: function () {\n        return getAssociatedLocation(this).sheets\n      },\n      set: function (sheets) {\n        getAssociatedLocation(this).update(sheets)\n      },\n    })\n  }\n  function traverseWebComponents(node, callback) {\n    var iter = document.createNodeIterator(\n      node,\n      NodeFilter.SHOW_ELEMENT,\n      function (foundNode) {\n        return getShadowRoot(foundNode)\n          ? NodeFilter.FILTER_ACCEPT\n          : NodeFilter.FILTER_REJECT\n      },\n      null,\n      false,\n    )\n    for (var next = void 0; (next = iter.nextNode()); ) {\n      callback(getShadowRoot(next))\n    }\n  }\n  var $element = new WeakMap()\n  var $uniqueSheets = new WeakMap()\n  var $observer = new WeakMap()\n  function isExistingAdopter(self, element) {\n    return (\n      element instanceof HTMLStyleElement &&\n      $uniqueSheets.get(self).some(function (sheet) {\n        return getAdopterByLocation(sheet, self)\n      })\n    )\n  }\n  function getAdopterContainer(self) {\n    var element = $element.get(self)\n    return element instanceof Document ? element.body : element\n  }\n  function adopt(self) {\n    var styleList = document.createDocumentFragment()\n    var sheets = $uniqueSheets.get(self)\n    var observer = $observer.get(self)\n    var container = getAdopterContainer(self)\n    observer.disconnect()\n    sheets.forEach(function (sheet) {\n      styleList.appendChild(\n        getAdopterByLocation(sheet, self) || addAdopterLocation(sheet, self),\n      )\n    })\n    container.insertBefore(styleList, null)\n    observer.observe(container, defaultObserverOptions)\n    sheets.forEach(function (sheet) {\n      restyleAdopter(sheet, getAdopterByLocation(sheet, self))\n    })\n  }\n  function Location(element) {\n    var self = this\n    self.sheets = []\n    $element.set(self, element)\n    $uniqueSheets.set(self, [])\n    $observer.set(\n      self,\n      new MutationObserver(function (mutations, observer) {\n        if (!document) {\n          observer.disconnect()\n          return\n        }\n        mutations.forEach(function (mutation) {\n          if (!hasShadyCss) {\n            forEach.call(mutation.addedNodes, function (node) {\n              if (!(node instanceof Element)) {\n                return\n              }\n              traverseWebComponents(node, function (root) {\n                getAssociatedLocation(root).connect()\n              })\n            })\n          }\n          forEach.call(mutation.removedNodes, function (node) {\n            if (!(node instanceof Element)) {\n              return\n            }\n            if (isExistingAdopter(self, node)) {\n              adopt(self)\n            }\n            if (!hasShadyCss) {\n              traverseWebComponents(node, function (root) {\n                getAssociatedLocation(root).disconnect()\n              })\n            }\n          })\n        })\n      }),\n    )\n  }\n  var proto$1 = Location.prototype\n  proto$1.isConnected = function isConnected() {\n    var element = $element.get(this)\n    return element instanceof Document\n      ? element.readyState !== 'loading'\n      : isElementConnected(element.host)\n  }\n  proto$1.connect = function connect() {\n    var container = getAdopterContainer(this)\n    $observer.get(this).observe(container, defaultObserverOptions)\n    if ($uniqueSheets.get(this).length > 0) {\n      adopt(this)\n    }\n    traverseWebComponents(container, function (root) {\n      getAssociatedLocation(root).connect()\n    })\n  }\n  proto$1.disconnect = function disconnect() {\n    $observer.get(this).disconnect()\n  }\n  proto$1.update = function update(sheets) {\n    var self = this\n    var locationType =\n      $element.get(self) === document ? 'Document' : 'ShadowRoot'\n    if (!Array.isArray(sheets)) {\n      throw new TypeError(\n        'Failed to set the \\'adoptedStyleSheets\\' property on ' +\n          locationType +\n          ': Iterator getter is not callable.',\n      )\n    }\n    if (!sheets.every(isCSSStyleSheetInstance)) {\n      throw new TypeError(\n        'Failed to set the \\'adoptedStyleSheets\\' property on ' +\n          locationType +\n          ': Failed to convert value to \\'CSSStyleSheet\\'',\n      )\n    }\n    if (sheets.some(isNonConstructedStyleSheetInstance)) {\n      throw new TypeError(\n        'Failed to set the \\'adoptedStyleSheets\\' property on ' +\n          locationType +\n          ': Can\\'t adopt non-constructed stylesheets',\n      )\n    }\n    self.sheets = sheets\n    var oldUniqueSheets = $uniqueSheets.get(self)\n    var uniqueSheets = unique(sheets)\n    var removedSheets = diff(oldUniqueSheets, uniqueSheets)\n    removedSheets.forEach(function (sheet) {\n      removeNode(getAdopterByLocation(sheet, self))\n      removeAdopterLocation(sheet, self)\n    })\n    $uniqueSheets.set(self, uniqueSheets)\n    if (self.isConnected() && uniqueSheets.length > 0) {\n      adopt(self)\n    }\n  }\n\n  window.CSSStyleSheet = ConstructedStyleSheet\n  attachAdoptedStyleSheetProperty(Document)\n  if ('ShadowRoot' in window) {\n    attachAdoptedStyleSheetProperty(ShadowRoot)\n    var proto = Element.prototype\n    var attach_1 = proto.attachShadow\n    proto.attachShadow = function attachShadow(init) {\n      var root = attach_1.call(this, init)\n      if (init.mode === 'closed') {\n        closedShadowRootRegistry.set(this, root)\n      }\n      return root\n    }\n  }\n  var documentLocation = getAssociatedLocation(document)\n  if (documentLocation.isConnected()) {\n    documentLocation.connect()\n  } else {\n    document.addEventListener(\n      'DOMContentLoaded',\n      documentLocation.connect.bind(documentLocation),\n    )\n  }\n})()\n","import { Component } from './component'\nimport { Fragment } from './utils'\n\nexport type Attributes = {\n  key?: string | number\n  ignoreAttrs?: boolean\n  children?: VNode[] | null\n  [prop: string]: unknown\n}\n\nexport type ObjectVNode = {\n  nodeName: string | Function | Component\n  attributes: Attributes\n  children: VNode[]\n  key?: string | number | undefined\n}\n\nif (!Array.prototype.flat) {\n  Array.prototype.flat = function (depth: number = 1): any[] {\n    const result: any[] = []\n\n    const flatten = (arr: any[], level: number) => {\n      for (const item of arr) {\n        if (Array.isArray(item) && level < depth) {\n          flatten(item, level + 1)\n        } else {\n          result.push(item)\n        }\n      }\n    }\n\n    // @ts-ignore\n    flatten(this, 0)\n    return result\n  }\n}\n\nexport type VNode = ObjectVNode | string | number | boolean | null | undefined\n\nexport function createElement(\n  nodeName: string | Function,\n  attributes: Attributes,\n  ...restChildren: VNode[] | unknown[]\n): VNode | VNode[] {\n  let children: VNode[] | undefined\n\n  // jsx 嵌套的元素自动忽略  attrs\n  if (attributes) {\n    if(typeof attributes.ignoreAttrs !== 'boolean'){\n      attributes.ignoreAttrs = true\n    }\n  } else {\n    attributes = { ignoreAttrs: true }\n  }\n\n  if (arguments.length > 2) {\n    children = restChildren.flat() as VNode[]\n  } else if (attributes.children != null) {\n    children = attributes.children as VNode[]\n    delete attributes.children\n  }\n\n  // fragment component\n  if (nodeName === Fragment) {\n    return children\n  } else if (typeof nodeName === 'function') {\n    if ((nodeName as unknown as Component).tagName) {\n      // class component\n      nodeName = (nodeName as unknown as Component).tagName\n    } else {\n      // function component\n      children && (attributes.children = children)\n      return nodeName(attributes)\n    }\n  }\n\n  const p: VNode = {\n    nodeName,\n    // @ts-ignore\n    children,\n    attributes,\n    key: attributes.key,\n  }\n\n  return p\n}\n\n// h.f or <></>\ncreateElement.f = Fragment\n\n/**\n * Clones the given VNode, optionally adding attributes/props and replacing its children.\n * @param vnode The virtual DOM element to clone\n * @param props Attributes/props to add when cloning\n * @param rest Any additional arguments will be used as replacement children.\n */\n\nexport function cloneElement(\n  vnode: ObjectVNode,\n  props: Attributes,\n  ...restChildren: VNode[] | unknown[]\n): VNode | VNode[] {\n  return createElement(\n    vnode.nodeName as string,\n    { ...vnode.attributes, ...props },\n    restChildren.length > 0 ? restChildren.flat() : vnode.children,\n  )\n}\n","export const DOM_EVENT_MAP = {\n  onanimationcancel: 1,\n  oncompositionend: 1,\n  oncompositionstart: 1,\n  oncompositionupdate: 1,\n  onfocusin: 1,\n  onfocusout: 1,\n  onscrollend: 1,\n  ontouchcancel: 1,\n  ontouchend: 1,\n  ontouchmove: 1,\n  ontouchstart: 1,\n}\n\nexport type EventTypes =\n  | 'onanimationcancel'\n  | 'oncompositionend'\n  | 'oncompositionstart'\n  | 'oncompositionupdate'\n  | 'onfocusin'\n  | 'onfocusout'\n  | 'onscrollend'\n  | 'ontouchcancel'\n  | 'ontouchend'\n  | 'ontouchmove'\n  | 'ontouchstart'\n\n// DOM properties that should NOT have \"px\" added when numeric\nexport const IS_NON_DIMENSIONAL =\n  /acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i\n","/**\n * An object containing registered directives.\n */\nexport const directives: { [key: string]: Function } = {}\n\n/**\n * Registers a directive with the specified name and handler.\n * @param name - The name of the directive.\n * @param handler - The handler function for the directive.\n */\nexport function registerDirective(name: string, handler: Function) {\n  directives['o-' + name] = handler\n}\n","import { Component } from './component'\nimport { IS_NON_DIMENSIONAL, DOM_EVENT_MAP, EventTypes } from './constants'\nimport { applyRef } from './utils'\nimport { directives } from './directive'\n\nexport type ExtendedElement = (HTMLElement | SVGAElement | HTMLInputElement) & {\n  receiveProps: Function\n  update: Function\n  queuedUpdate: Function\n  store?: unknown\n  className?: string\n  props: Record<string, unknown>\n  splitText?: Function\n  prevProps?: Record<string, unknown> & {\n    ref?:\n      | {\n          current?: unknown\n        }\n      | Function\n  }\n  attributes: NamedNodeMap\n  _component?: Component\n  _listeners: Record<string, Function>\n} & Record<string, unknown>\n\n/**\n * Create an element with the given nodeName.\n * @param {string} nodeName The DOM node to create\n * @param {boolean} [isSvg=false] If `true`, creates an element within the SVG\n *  namespace.\n * @returns {Element} The created DOM node\n */\nexport function createNode(nodeName: string, isSvg: boolean) {\n  /** @type {Element} */\n  let node = isSvg\n    ? document.createElementNS('http://www.w3.org/2000/svg', nodeName)\n    : document.createElement(nodeName)\n  // @ts-ignore\n  node.normalizedNodeName = nodeName\n  return node as ExtendedElement\n}\n\n/**\n * Remove a child node from its parent if attached.\n * @param {Node} node The node to remove\n */\nexport function removeNode(node: Element) {\n  let parentNode = node.parentNode\n  if (parentNode) parentNode.removeChild(node)\n}\n\n/**\n * Set a named attribute on the given Node, with special behavior for some names\n * and event handlers. If `value` is `null`, the attribute/handler will be\n * removed.\n * @param {Element} node An element to mutate\n * @param {string} name The name/key to set, such as an event or attribute name\n * @param {*} old The last value that was set for this name/node pair\n * @param {*} value An attribute value, such as a function to be used as an\n *  event handler\n * @param {boolean} isSvg Are we currently diffing inside an svg?\n * @private\n */\nexport function setAccessor(\n  node: ExtendedElement,\n  name: string,\n  old: any,\n  value: any,\n  isSvg: boolean,\n) {\n  if (name === 'className') name = 'class'\n\n  if (name[0] == 'o' && name[1] == '-') {\n    // 因为需要访问 node 上的属性，所以这里用 Promise.resolve().then\n    Promise.resolve().then(() => {\n      directives[name]?.(node, value)\n    })\n  }\n  if (name === 'key' || name === 'ignoreAttrs') {\n    // ignore\n  } else if (name === 'ref') {\n    applyRef(old, null)\n    applyRef(value, node)\n  } else if (name === 'class' && !isSvg) {\n    node.className = value || ''\n  } else if (name === 'style') {\n    if (typeof value == 'string') {\n      node.style.cssText = value\n    } else {\n      if (typeof old == 'string') {\n        node.style.cssText = old = ''\n      }\n\n      if (old) {\n        for (name in old) {\n          if (!(value && name in value)) {\n            setStyle(node.style, name, '')\n          }\n        }\n      }\n\n      if (value) {\n        for (name in value) {\n          if (!old || value[name] !== old[name]) {\n            setStyle(node.style, name, value[name])\n          }\n        }\n      }\n    }\n  } else if (name === 'unsafeHTML') {\n    if (value) node.innerHTML = value.html || value || ''\n  } else if (name[0] == 'o' && name[1] == 'n') {\n    bindEvent(node, name, value, old)\n  } else if (node.nodeName === 'INPUT' && name === 'value') {\n    ;(node as HTMLInputElement).value = value == null ? '' : value\n  } else if (\n    name !== 'list' &&\n    name !== 'type' &&\n    name !== 'css' &&\n    !isSvg &&\n    name in node\n  ) {\n    //value !== '' fix for selected, disabled, checked with pure element\n    // Attempt to set a DOM property to the given value.\n    // IE & FF throw for certain property-value combinations.\n    try {\n      node[name] = value == null ? '' : value\n    } catch (e) {}\n    if ((value == null || value === false) && name != 'spellcheck')\n      node.removeAttribute(name)\n  } else {\n    let ns = isSvg && name !== (name = name.replace(/^xlink:?/, ''))\n    // spellcheck is treated differently than all other boolean values and\n    // should not be removed when the value is `false`. See:\n    // https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-spellcheck\n    if (value == null || value === false) {\n      if (ns)\n        node.removeAttributeNS(\n          'http://www.w3.org/1999/xlink',\n          name.toLowerCase(),\n        )\n      else node.removeAttribute(name)\n    } else if (typeof value !== 'function') {\n      if (ns) {\n        node.setAttributeNS(\n          'http://www.w3.org/1999/xlink',\n          name.toLowerCase(),\n          value,\n        )\n      } else {\n        if ((node.constructor as typeof Component).is === 'Component') {\n          const reflect = (node.constructor as typeof Component).reflectProps?.[\n            name\n          ]\n          if (reflect) {\n            node.setAttribute(\n              name,\n              typeof reflect === 'function' ? reflect(value) : value,\n            )\n          }\n        } else {\n          node.setAttribute(name, value)\n        }\n      }\n    }\n  }\n}\n\n/**\n * Proxy an event to hooked event handlers\n * @param {Event} e The event object from the browser\n * @private\n */\nfunction eventProxy(e: Event) {\n  // @ts-ignore\n  return this._listeners[e.type](e)\n}\n\nfunction bindEvent(node: ExtendedElement, name: string, value: any, old: any) {\n  let useCapture = name !== (name = name.replace(/Capture$/, ''))\n  let nameLower = name.toLowerCase()\n  name = (\n    DOM_EVENT_MAP[nameLower as EventTypes] || nameLower in node\n      ? nameLower\n      : name\n  ).slice(2)\n  if (value) {\n    if (!old) {\n      node.addEventListener(name, eventProxy, useCapture)\n    }\n  } else {\n    node.removeEventListener(name, eventProxy, useCapture)\n  }\n  ;(node._listeners || (node._listeners = {}))[name] = value\n}\n\nfunction setStyle(\n  style: CSSStyleDeclaration,\n  key: string,\n  value: string | number | null,\n) {\n  if (key[0] === '-') {\n    style.setProperty(key, value == null ? '' : value.toString())\n  } else if (value == null) {\n    ;(style as any)[key] = ''\n  } else if (typeof value != 'number' || IS_NON_DIMENSIONAL.test(key)) {\n    ;(style as any)[key] = value.toString()\n  } else {\n    ;(style as any)[key] = value + 'px'\n  }\n}\n","import { isSameNodeType, isNamedNode, camelCase, isArray } from './utils'\nimport { createNode, setAccessor, removeNode } from './dom'\nimport { ObjectVNode, VNode } from './vdom'\nimport { Component } from './component'\nimport { ExtendedElement } from './dom'\n\n/** Diff recursion count, used to track the end of the diff cycle. */\nexport let diffLevel = 0\n\n/** Global flag indicating if the diff is currently within an SVG */\nlet isSvgMode = false\nlet isForeignObject = false\n/** Global flag indicating if the diff is performing hydration */\nlet hydrating = false\n\n/** Apply differences in a given vnode (and it's deep children) to a real DOM Node.\n *  @param {Element} [dom=null]    A DOM node to mutate into the shape of the `vnode`\n *  @param {VNode} vnode      A VNode (with descendants forming a tree) representing the desired DOM structure\n *  @returns {Element} dom      The created/mutated element\n *  @private\n */\nexport function diff(\n  dom: ExtendedElement | ExtendedElement[] | null,\n  vnode: VNode | VNode[],\n  parent: ExtendedElement | null,\n  component: Component | null,\n  updateSelf: boolean,\n): ExtendedElement | ExtendedElement[] | null {\n  // first render return undefined\n  if (!dom && !vnode) return null\n\n  // fix repeated rendering\n  if (component && (component.constructor as typeof Component).isLightDOM) {\n    component.innerHTML = ''\n  }\n\n  // diffLevel having been 0 here indicates initial entry into the diff (not a subdiff)\n  let ret\n  if (!diffLevel++) {\n    // when first starting the diff, check if we're diffing an SVG or within an SVG\n    isSvgMode =\n      parent != null &&\n      (parent as Element as SVGElement).ownerSVGElement !== undefined\n\n    // hydration is indicated by the existing element to be diffed not having a prop cache\n    // hydrating = dom != null && !('prevProps' in dom)\n\n    // SSR is currently not supported\n    hydrating = false\n  }\n\n  if (isArray(vnode)) {\n    if (parent) {\n      // don't use props.css when using h.f? can we use now?\n      // diff node list and vnode list\n      innerDiffNode(\n        parent,\n        vnode as VNode[],\n        hydrating,\n        component as Component,\n        updateSelf,\n      )\n      ret = parent.childNodes\n    } else {\n      // connectedCallback 的时候 parent 为 null\n      ret = []\n      ;(vnode as unknown as VNode[]).forEach((item, index) => {\n        let ele = idiff(\n          index === 0 ? dom : null,\n          item,\n          component as Component,\n          updateSelf,\n        )\n        // 返回数组的情况下，在 Component 中进行了 shadowRoot.appendChild\n        // 所有不会出现 vnode index 大于 0 丢失的情况\n        ret.push(ele)\n      })\n    }\n  } else {\n    if (isArray(dom) || dom instanceof NodeList) {\n      // recollectNodeTree will remove dom from the DOM, so we need [...dom] to make a copy\n      ;[...(dom as ExtendedElement[])].forEach((child, index) => {\n        if (index === 0) {\n          ret = idiff(child, vnode as VNode, component as Component, updateSelf)\n        } else {\n          recollectNodeTree(child, false)\n        }\n      })\n    } else {\n      ret = idiff(dom, vnode as VNode, component as Component, updateSelf)\n    }\n    // append the element if its a new parent\n    if (parent && (ret as Node)?.parentNode !== parent)\n      parent.appendChild(ret as Node)\n  }\n\n  // diffLevel being reduced to 0 means we're exiting the diff\n  if (!--diffLevel) {\n    hydrating = false\n    // invoke queued componentDidMount lifecycle methods\n  }\n\n  return ret as ExtendedElement | ExtendedElement[] | null\n}\n\n/** Internals of `diff()`, separated to allow bypassing diffLevel / mount flushing. */\nfunction idiff(\n  dom: ExtendedElement | ExtendedElement[] | null | Text | HTMLElement,\n  vnode: VNode,\n  component: Component,\n  updateSelf: boolean,\n) {\n  if (dom && vnode && (dom as ExtendedElement).props) {\n    ;(dom as ExtendedElement).props.children = (vnode as ObjectVNode).children\n  }\n  let out = dom,\n    prevSvgMode = isSvgMode,\n    prevForeignObject = isForeignObject\n\n  // empty values (null, undefined, booleans) render as empty Text nodes\n  if (vnode == null || typeof vnode === 'boolean') vnode = ''\n\n  // Fast case: Strings & Numbers create/update Text nodes.\n  if (typeof vnode === 'string' || typeof vnode === 'number') {\n    // update if it's already a Text node:\n    if (\n      dom &&\n      (dom as ExtendedElement).splitText !== undefined &&\n      (dom as ExtendedElement).parentNode &&\n      (!(dom as ExtendedElement)._component || component)\n    ) {\n      /* istanbul ignore if */ /* Browser quirk that can't be covered: https://github.com/developit/preact/commit/fd4f21f5c45dfd75151bd27b4c217d8003aa5eb9 */\n      if ((dom as ExtendedElement).nodeValue != vnode) {\n        ;(dom as ExtendedElement).nodeValue = String(vnode)\n      }\n    } else {\n      // it wasn't a Text node: replace it with one and recycle the old Element\n      out = document.createTextNode(String(vnode))\n      if (dom) {\n        if ((dom as Text).parentNode)\n          (dom as Text).parentNode?.replaceChild(out, dom as Text)\n        recollectNodeTree(dom as ExtendedElement, true)\n      }\n    }\n\n    if (out) {\n      ;(out as ExtendedElement).prevProps = {}\n    }\n\n    return out\n  }\n\n  let vnodeName = vnode.nodeName\n  // if (typeof vnodeName !== 'string') {\n  //   vnodeName = (vnodeName as Component).tagName\n  // }\n\n  // Tracks entering and exiting SVG namespace when descending through the tree.\n  isForeignObject = vnodeName === 'foreignObject'\n  isSvgMode = vnodeName === 'svg' ? true : isForeignObject ? false : isSvgMode\n\n  // If there's no existing element or it's the wrong type, create a new one:\n  vnodeName = String(vnodeName)\n  if (!dom || !isNamedNode(dom as ExtendedElement, vnodeName)) {\n    // foreignObject 自身 isSvgMode 设置成 true，内部设置成 false\n    // 创建 component 时，会执行构造函数\n    out = createNode(vnodeName, isForeignObject || isSvgMode)\n    // 如果是组件，需要把 props 传递给组件，不然 install 里拿不到 props\n    if ((out.constructor as typeof Component)?.is === 'Component') {\n      Object.assign((out as ExtendedElement).props, vnode.attributes)\n    }\n    if (dom) {\n      // move children into the replacement node\n      while ((dom as ExtendedElement).firstChild)\n        (out as HTMLElement).appendChild(\n          (dom as ExtendedElement).firstChild as Node,\n        )\n\n      // if the previous Element was mounted into the DOM, replace it inline\n      if ((dom as ExtendedElement).parentNode)\n        (dom as ExtendedElement).parentNode?.replaceChild(\n          out as HTMLElement,\n          dom as ExtendedElement,\n        )\n\n      // recycle the old element (skips non-Element node types)\n      recollectNodeTree(dom as ExtendedElement, true)\n    }\n  }\n\n  let fc = (out as ExtendedElement).firstChild,\n    props = (out as ExtendedElement).prevProps,\n    vchildren = vnode.children\n\n  if (props == null) {\n    props = (out as ExtendedElement).prevProps = {}\n    for (let a = (out as ExtendedElement).attributes, i = a.length; i--; )\n      props[a[i].name] = a[i].value\n  }\n\n  // Optimization: fast-path for elements containing a single TextNode:\n  if (\n    !hydrating &&\n    vchildren &&\n    vchildren.length === 1 &&\n    typeof vchildren[0] === 'string' &&\n    fc != null &&\n    (fc as Text).splitText !== undefined &&\n    fc.nextSibling == null\n  ) {\n    if (fc.nodeValue != vchildren[0]) {\n      fc.nodeValue = vchildren[0]\n    }\n  }\n  // otherwise, if there are existing or new children, diff them:\n  else if ((vchildren && vchildren.length) || fc != null) {\n    if (\n      !(\n        ((out as ExtendedElement).constructor as typeof Component).is ==\n          'Component' &&\n        ((out as ExtendedElement).constructor as typeof Component).noSlot\n      )\n    ) {\n      innerDiffNode(\n        out as ExtendedElement,\n        vchildren,\n        hydrating || props.unsafeHTML != null,\n        component,\n        updateSelf,\n      )\n    }\n  }\n\n  // Apply attributes/props from VNode to the DOM Element:\n  diffAttributes(\n    out as ExtendedElement,\n    vnode.attributes,\n    props,\n    component,\n    updateSelf,\n  )\n  if ((out as ExtendedElement).props) {\n    ;(out as ExtendedElement).props.children = vnode.children\n  }\n  // restore previous SVG mode: (in case we're exiting an SVG namespace)\n  isSvgMode = prevSvgMode\n  isForeignObject = prevForeignObject\n  return out\n}\n\n/** Apply child and attribute changes between a VNode and a DOM Node to the DOM.\n *  @param {Element} dom      Element whose children should be compared & mutated\n *  @param {Array} vchildren    Array of VNodes to compare to `dom.childNodes`\n *  @param {Boolean} isHydrating  If `true`, consumes externally created elements similar to hydration\n */\nfunction innerDiffNode(\n  dom: ExtendedElement,\n  vchildren: VNode[],\n  isHydrating: boolean,\n  component: Component,\n  updateSelf: boolean,\n) {\n  let originalChildren = dom.childNodes,\n    children = [],\n    keyed: Record<string, Element | undefined> = {},\n    keyedLen = 0,\n    min = 0,\n    len = originalChildren.length,\n    childrenLen = 0,\n    vlen = vchildren ? vchildren.length : 0,\n    j,\n    c,\n    f,\n    vchild,\n    child\n\n  // Build up a map of keyed children and an Array of unkeyed children:\n  if (len !== 0) {\n    for (let i = 0; i < len; i++) {\n      let child = originalChildren[i],\n        prevProps = (child as ExtendedElement).prevProps,\n        key = vlen && prevProps ? prevProps.key : null\n\n      if (key != null) {\n        keyedLen++\n        keyed[key as string] = child as Element\n      } else if (\n        prevProps || // 拥有 prevProps 的进入 children，进入 children 后面才会被回收\n        ((child as ExtendedElement).splitText !== undefined\n          ? isHydrating\n            ? (child as Text).nodeValue?.trim()\n            : true\n          : isHydrating)\n      ) {\n        children[childrenLen++] = child\n      }\n    }\n  }\n\n  if (vlen !== 0) {\n    for (let i = 0; i < vlen; i++) {\n      vchild = vchildren[i]\n      child = null\n\n      if (vchild) {\n        // attempt to find a node based on key matching\n        let key = (vchild as ObjectVNode).key\n        if (key != null) {\n          if (keyedLen && keyed[key] !== undefined) {\n            child = keyed[key]\n            keyed[key] = undefined\n            keyedLen--\n          }\n        }\n        // attempt to pluck a node of the same type from the existing children\n        else if (min < childrenLen) {\n          for (j = min; j < childrenLen; j++) {\n            if (\n              children[j] !== undefined &&\n              isSameNodeType((c = children[j] as ExtendedElement), vchild)\n            ) {\n              child = c\n              children[j] = undefined\n              if (j === childrenLen - 1) childrenLen--\n              if (j === min) min++\n              break\n            }\n          }\n        }\n      }\n\n      // morph the matched/found/created DOM child to match vchild (deep)\n      child = idiff(child as ExtendedElement, vchild, component, updateSelf)\n\n      f = originalChildren[i]\n      if (child && child !== dom && child !== f) {\n        if (f == null) {\n          dom.appendChild(child as Element)\n        } else if (child === f.nextSibling) {\n          removeNode(f as Element)\n        } else {\n          dom.insertBefore(child as Element, f)\n        }\n      }\n    }\n  }\n\n  // remove unused keyed children:\n  if (keyedLen) {\n    for (let i in keyed)\n      if (keyed[i] !== undefined)\n        recollectNodeTree(keyed[i] as ExtendedElement, false)\n  }\n\n  // remove orphaned unkeyed children:\n  while (min <= childrenLen) {\n    if ((child = children[childrenLen--]) !== undefined)\n      recollectNodeTree(child as ExtendedElement, false)\n  }\n}\n\n/** Recursively recycle (or just unmount) a node and its descendants.\n *  @param {Node} node            DOM node to start unmount/removal from\n *  @param {Boolean} [unmountOnly=false]  If `true`, only triggers unmount lifecycle, skips removal\n */\nexport function recollectNodeTree(node: ExtendedElement, unmountOnly: boolean) {\n  // If the node's VNode had a ref function, invoke it with null here.\n  // (this is part of the React spec, and smart for unsetting references)\n  if (node.prevProps != null && node.prevProps.ref) {\n    if (typeof node.prevProps.ref === 'function') {\n      node.prevProps.ref(null)\n    } else if (node.prevProps.ref.current) {\n      node.prevProps.ref.current = null\n    }\n  }\n\n  if (unmountOnly === false || node.prevProps == null) {\n    removeNode(node)\n  }\n\n  removeChildren(node)\n}\n\n/** Recollect/unmount all children.\n *  - we use .lastChild here because it causes less reflow than .firstChild\n *  - it's also cheaper than accessing the .childNodes Live NodeList\n */\nexport function removeChildren(node: ChildNode | null | undefined) {\n  node = node?.lastChild\n  while (node) {\n    let next = node.previousSibling\n    recollectNodeTree(node as ExtendedElement, true)\n    node = next\n  }\n}\n\n/** Apply differences in attributes from a VNode to the given DOM Element.\n *  @param {Element} dom    Element with attributes to diff `attrs` against\n *  @param {Object} attrs    The desired end-state key-value attribute pairs\n *  @param {Object} old      Current/previous attributes (from previous VNode or element's prop cache)\n */\nfunction diffAttributes(\n  dom: ExtendedElement,\n  attrs: Record<string, unknown>,\n  old: Record<string, unknown>,\n  component: Component,\n  updateSelf: boolean,\n) {\n  let name\n  // let update = false\n  let isComponent = dom.update\n  let oldClone;\n\n  // merge defaultProps and props with their default values into oldClone\n  if (dom.receiveProps) {\n    oldClone = Object.assign({}, old);\n\n    // merge defaultProps\n    if (dom) {\n      if ((dom.constructor as typeof Component).defaultProps) {\n        const defaultProps = (dom.constructor as typeof Component).defaultProps;\n        for (const propName in defaultProps) {\n          if (oldClone[propName] === undefined) {\n            oldClone[propName] = defaultProps[propName];\n          }\n        }\n      }\n\n      // merge props with default values\n      if ((dom.constructor as typeof Component).props) {\n        const props = (dom.constructor as typeof Component).props;\n        for (const propName in props) {\n          // @ts-ignore\n          if (props[propName]?.default !== undefined && oldClone[propName] === undefined) {\n            // @ts-ignore\n            oldClone[propName] = props[propName].default;\n          }\n        }\n      }\n    }\n  }\n\n  // remove attributes no longer present on the vnode by setting them to undefined\n  for (name in old) {\n    if (!(attrs && attrs[name] != null) && old[name] != null) {\n      setAccessor(\n        dom,\n        name,\n        old[name],\n        (old[name] = undefined),\n        isForeignObject || isSvgMode,\n      )\n      if (isComponent) {\n        delete dom.props[name]\n        // update = true\n      }\n    }\n  }\n\n  // add new & update changed attributes\n  for (name in attrs) {\n    if (isComponent && typeof attrs[name] === 'object' && name !== 'ref') {\n      if (name === 'style' || (name[0] === 'o' && name[1] === '-')) {\n        setAccessor(\n          dom,\n          name,\n          old[name],\n          (old[name] = attrs[name]),\n          isForeignObject || isSvgMode,\n        )\n      }\n      let ccName = camelCase(name)\n      dom.props[ccName] = old[ccName] = attrs[name]\n      //update = true\n    } else if (\n      name !== 'children' &&\n      (!(name in old) ||\n        attrs[name] !==\n          (name === 'value' || name === 'checked' ? dom[name] : old[name]))\n    ) {\n      setAccessor(\n        dom,\n        name,\n        old[name],\n        attrs[name],\n        isForeignObject || isSvgMode,\n      )\n      // fix lazy load props missing\n      if (dom.nodeName.indexOf('-') !== -1) {\n        dom.props = dom.props || {}\n        let ccName = camelCase(name)\n        dom.props[ccName] = old[ccName] = attrs[name]\n        // update = true\n      } else {\n        old[name] = attrs[name]\n      }\n    }\n  }\n\n  if (isComponent && !updateSelf && dom.parentNode) {\n    // __hasChildren is not accuracy when it was empty at first, so add dom.children.length > 0 condition\n    // if (update || dom.__hasChildren || dom.children.length > 0 || (dom.store && !dom.store.data)) {\n    if (dom?.receiveProps?.(dom.props, oldClone) !== false) {\n      // 如果这里使用 update，会导致子、孙等等的重复更新，所有用queuedUpdate，\n      // 详细见 repeat-rendering-test 的测试demo\n      // 如果需要完全去掉 queuedUpdate 变成同步更新，需要：\n      // 1. signal的依赖和computed的依赖组件产生的更新需要合并\n      // 2. 收集到的组件需要按照嵌套关系进行去重，只保留最外层的组件\n      dom?.queuedUpdate?.()\n    }\n    // }\n  }\n}\n","export const options = {\n  mixin: {} as Record<string, unknown>,\n  // 全局样式\n  globalCSS: [] as CSSStyleSheet[],\n}\n\nexport function mixin(obj: Record<string, unknown>) {\n  Object.assign(options.mixin, obj)\n}\n\n// 注入全局样式\nexport function globalCSS(css: CSSStyleSheet) {\n  if (!options.globalCSS.includes(css)) {\n    options.globalCSS.push(css)\n  }\n}\n","/**\n *\n * 为组件添加表单关联功能\n *\n * 即当表单元素内部包含组件时，组件可以与表单元素进行交互\n *\n *\n *\n *\n *\n */\n\nimport { FormAssociatedComponent } from '../component'\n\nexport default {\n  define: (cls: typeof FormAssociatedComponent) => {\n    cls.prototype.formAssociatedCallback = function (form) {\n      this._form = form\n      if (this._form) {\n        // 当组件被添加到表单元素内部时，监听 formdata 事件\n        this._form.addEventListener('formdata', this.handleFormData.bind(this))\n      }\n    }\n    // cls.prototype.formDisabledCallback = function() {\n    // \t//  禁用 input 元素\n    // }\n    // cls.prototype.formResetCallback = function() {\n    // \tthis._internals?.setFormValue('')\n    // }\n    // cls.prototype.formStateRestoreCallback = function(state:any, mode:any) {\n    // \t//  根据 state 和 mode 恢复表单元素状态\n    // }\n  },\n  initial: (self: FormAssociatedComponent) => {\n    // 返回表单元素的值，格式为 [name, value]\n    if (!self.getFieldValue) {\n      self.getFieldValue = function () {\n        const values: Record<string, any> = {}\n        self._inputs = self.shadowRoot?.querySelectorAll(\n          'input',\n        ) as unknown as HTMLInputElement[]\n        self._inputs.forEach((input) => {\n          values[input.name] = input.value\n        })\n        return values\n      }\n    }\n    if (!self.resetFieldValue) {\n      self.resetFieldValue = function () {\n        self._inputs = self.shadowRoot?.querySelectorAll(\n          'input',\n        ) as unknown as HTMLInputElement[]\n        self._inputs.forEach((input) => {\n          input.value = ''\n        })\n      }\n    }\n    if (!self.handleFormData) {\n      self.handleFormData = function ({ formData }) {\n        if (formData) {\n          const values = self.getFieldValue()\n          Object.entries(values).forEach(([name, value]) => {\n            formData.append(name, value)\n          })\n        }\n      }\n    }\n    self._internals = self.attachInternals()\n  },\n  connected: (self: FormAssociatedComponent) => {},\n}\n","import { default as formAssociatedHook } from './hooks/formAssociated'\nimport { executeComponentHooks, installHook } from './utils'\n\n/**\n * Defines a custom element.\n * @param tagName - The tagName of the custom element.\n * @param ctor - The constructor function for the custom element.\n */\nexport function define(tagName: string, ctor: CustomElementConstructor): void {\n  // 重复定义也需要挂载 tagName，防止重复定义时候被使用没有 tagName 当作函数\n  Object.defineProperty(ctor, 'tagName', { value: tagName, writable: false })\n  if (customElements.get(tagName)) {\n    console.warn(\n      `Failed to execute 'define' on 'CustomElementRegistry': the tag name \"${tagName}\" has already been used with this registry`,\n    )\n    return\n  }\n  customElements.define(tagName, ctor)\n}\n\nexport function tag(tagName: string, options?: { formAssociated?: boolean }) {\n  const { formAssociated } = Object.assign(\n    {\n      formAssociated: false,\n    },\n    options,\n  )\n  return function (target: CustomElementConstructor) {\n    if (formAssociated) {\n      if (formAssociated) {\n        installHook(target, formAssociatedHook as any)\n        // @ts-ignore\n        target.formAssociated = true\n      }\n      executeComponentHooks(target, 'define')\n    }\n    define(tagName, target)\n  }\n}\n\nexport const webcomponent = tag\n","/**\n *\n * 为组件添加ref自动转发功能\n *\n * ref自动转发的目的是为了让组件的使用者可以直接通过组件实例获取到内部元素的引用，\n * 特别是组件多层嵌套时，可以通过ref获取到任意层级的组件实例，而不需要层层传递ref\n *\n *\n * 工作原理:\n *\n * 1. 为组件定义一个ref prop，这是约定的名称\n * 2. 在组件实例可以通过this.ref获取到ref对象，可以将this.ref绑定到任意内部元素上\n * 3.\n *\n *\n *\n *\n */\n\nimport { type Component, type Ref } from '../component'\n\nexport default {\n  /**\n   * 为组件实例动态添加ref属性\n   * @param self\n   */\n  initial: (self: Component) => {\n    // 声明ref属性，该属性是一个proxy对象，当set时会在当前组件触发refAttach事件\n\n    Object.defineProperty(self, 'ref', {\n      get() {\n        if (!self._ref) {\n          self._ref = new Proxy<Ref>(\n            {\n              current: undefined,\n            },\n            {\n              set(target, key, value, receiver) {\n                if (key === 'current') {\n                  self.fire(\n                    'refAttached',\n                    {\n                      ref: value,\n                      target: self,\n                    },\n                    { bubbles: true, composed: true },\n                  )\n                }\n                return Reflect.set(target, key, value, receiver)\n              },\n            },\n          )\n        }\n        return self._ref\n      },\n    })\n    // @ts-ignore\n    self._onRefAttached = function (e: any) {\n      const { ref, target } = e.detail\n      if (target !== self) {\n        // @ts-ignore\n        if (self.props.ref) self.props.ref.current = ref\n      }\n    }\n    // @ts-ignore\n    self.addEventListener('refAttached', self._onRefAttached)\n  },\n  disconnected: (self: Component) => {\n    // @ts-ignore\n    self.removeEventListener('refAttached', self._onRefAttached)\n  },\n}\n","// @ts-nocheck\nimport {\n  isArray,\n  hyphenate,\n  capitalize,\n  camelCase,\n  createStyleSheet,\n  getClassStaticValue,\n  isObject,\n  createRef,\n  installHook,\n  convertNodeListToVNodes,\n} from './utils'\nimport { diff } from './diff'\nimport { ExtendedElement } from './dom'\nimport 'weakmap-polyfill'\nimport { ObjectVNode, VNode, createElement } from './vdom'\nimport { setActiveComponent, clearActiveComponent } from 'reactive-signal'\nimport { options } from './options'\nimport { define } from './define'\nimport forwardRef from './hooks/forwardRef'\n\nlet id = 0\n\nconst adoptedStyleSheetsMap = new WeakMap()\ntype Module = { default: string }\ntype CSSItem = Module | string\n\ntype PropType = Object | Number | String | Boolean\n\ntype PropTypes = {\n  [key: string]: PropType | Array<PropType>\n}\n\ntype ReflectProps = {\n  [key: string]: boolean | ((propValue: any) => any)\n}\n\nexport type ComponentHookType =\n  | 'define'\n  | 'initial'\n  | 'connected'\n  | 'disconnected'\nexport type ComponentHooks = {\n  [key in Omit<ComponentHookType, 'define'>]?: (self: Component) => void\n} & {\n  define: (cls: typeof Component) => void\n}\nexport type ComponentHookRegistry = Record<\n  ComponentHookType,\n  ((self: Component) => void)[]\n>\nexport type Ref<T = any> = { current?: T }\n\nexport class Component<State = any> extends HTMLElement {\n  static h = createElement\n  static f = createElement.f\n\n  static is = 'Component'\n  static defaultProps: Record<string, unknown>\n  static reflectProps: ReflectProps\n  static propTypes: PropTypes\n  static css: CSSItem | CSSItem[]\n  static isLightDOM: boolean\n  static noSlot: boolean\n  static hooks: ComponentHookRegistry\n  // 被所有组件继承\n  static props = {}\n  // 是否针对复杂类型使用DOMProperty的方式传值\n  static useDOMProperty = true\n\n  // 可以延迟定义，防止 import { }  被 tree-shaking 掉\n  static define(name: string): void {\n    define(name, this)\n  }\n  // 不能声明 props，不然懒加载的 props 执行完构造函数会变成 udnefined, 会导致元素升级为自定义元素之前的 props 丢失\n  // props: Record<string, unknown>\n  // 不能声明 prevProps，不然懒加载的 prevProps 执行完构造函数会变成 udnefined, 会导致元素升级为自定义元素之前的 prevProps 丢失\n  // prevProps: Record<string, unknown> | null\n  elementId: number\n  isInstalled: boolean\n  inject?: string[]\n  injection?: { [key: string]: unknown }\n  renderRoot?: ExtendedElement | ShadowRoot | Component\n  rootElement: ExtendedElement | ExtendedElement[] | null\n  _hooks: Record<ComponentHookType, Function[]>\n  _ref: Partial<Record<'current', any>> = null\n  static formAssociated = true\n  constructor() {\n    super()\n    this.handleProps()\n    // 安装一些内置钩子\n    installHook(this, forwardRef)\n    this.executeHooks('initial')\n    this.elementId = id++\n    this.isInstalled = false\n    this.rootElement = null\n  }\n\n  get ref(): Ref {\n    // 具体实现由 forwardRef hook提供，这里只是为了提供类型提示\n  }\n\n  /**\n   * 获取已经声明的钩子函数\n   */\n  get hooks() {\n    if (!this._hooks) {\n      this._hooks = getClassStaticValue(this, 'hooks') || {}\n    }\n    return this._hooks\n  }\n\n  /**\n   * 执行指定名称的钩子函数\n   */\n  private executeHooks(hookName: ComponentHookType) {\n    if (hookName in this.hooks) {\n      const hooks = this.hooks[hookName]\n      if (Array.isArray(hooks)) {\n        hooks.forEach((hook) => {\n          try {\n            hook.call(this, this)\n          } catch (e: any) {\n            console.warn(\n              `Error occurred while executing hook function ${this.constructor.name}/${hookName}:`,\n              e,\n            )\n          }\n        })\n      }\n    }\n  }\n\n  /**\n   * 处理props\n   *\n   * 为方便组件继承，会读取类继承链上的props、defaultProps、propTypes、reflectProps等属性进行合并\n   * 这样子组件就可以继承父组件的props、defaultProps、propTypes、reflectProps等属性\n   *\n   *\n   */\n  private handleProps() {\n    this.constructor.defaultProps =\n      getClassStaticValue(this, 'defaultProps', { default: {} }) || {}\n    this.constructor.propTypes =\n      getClassStaticValue(this, 'propTypes', { default: {} }) || {}\n    this.constructor.reflectProps =\n      getClassStaticValue(this, 'reflectProps', { default: {} }) || {}\n    const props = getClassStaticValue(this, 'props', {\n      default: {},\n      merge: 'uniqueMerge',\n    })\n\n    if (this.constructor.props) {\n      for (const propName in props) {\n        const prop = props[propName]\n        this.constructor.defaultProps[propName] = prop.default\n        this.constructor.propTypes[propName] = prop.type\n        this.constructor.reflectProps[propName] = prop.reflect\n      }\n    }\n\n    // @ts-ignore fix lazy load props missing\n    this.props = Object.assign({}, this.constructor.defaultProps, this.props)\n\n    if (!this.props.ignoreAttrs) {\n      this.handleComplexProps()\n    }\n  }\n\n  /**\n   * 处理复杂类型的属性，如对象、数组，使用 DOM Property 的方式获取值\n   * 其它基本类型使用 attribute 的方式获取值\n   */\n  private handleComplexProps() {\n    const propTypes = this.constructor.propTypes as PropTypes\n    Object.keys(propTypes).forEach(propName => {\n      // 检查是否是复杂类型\n      const isComplexType = this.constructor.isComplexType(propName)\n      if (isComplexType) {\n        Object.defineProperty(this, propName, {\n          get: () => this.props[propName],\n          set: (value) => {\n            if (Object.is(value, this.props[propName])) return\n\n            this.props[propName] = value\n            this.queuedUpdate()\n          },\n          enumerable: true,\n          configurable: true\n        })\n      }\n    })\n  }\n\n  static isComplexType(propName: string) {\n    if (!this.useDOMProperty) return false\n\n    const propTypes = this.propTypes as PropTypes\n    if (!propTypes[propName] || /^on|children/.test(propName)) {\n      return false\n    }\n    const types = isArray(propTypes[propName])\n      ? propTypes[propName] as PropType[]\n      : [propTypes[propName]] as PropType[]\n\n    // 检查是否是复杂类型\n    return types.some(t =>\n      t === Object || t === Array || (isArray(t) && t.includes(Object))\n    )\n  }\n\n  static get observedAttributes() {\n    // 兼容之前老的逻辑\n    if (Object.keys(this.props || {}).length > 0) {\n      return Object.keys(this.props).map(hyphenate)\n    }\n    // 根据 propTypes 获取需要监听的属性\n    if (Object.keys(this.propTypes || {}).length > 0) {\n      return Object.keys(this.propTypes)\n        .filter((p) => !/^on|children/.test(p) && !this.isComplexType(p))\n        .map(hyphenate)\n    }\n    return []\n  }\n\n  attributeChangedCallback(name, oldValue, newValue) {\n    const propName = camelCase(name)\n    if (this.constructor.props && this.constructor.props[propName]) {\n      const prop = this.constructor.props[propName]\n      if (prop.changed) {\n        const newTypeValue = this.getTypeValueOfProp(propName, newValue)\n        const oldTypeValue = this.getTypeValueOfProp(propName, oldValue)\n        prop.changed.call(this, newTypeValue, oldTypeValue)\n      }\n    }\n    if (!this.props.ignoreAttrs) {\n      this.update()\n    }\n  }\n\n  state: State\n\n  setState(partialState: Partial<State>, beforeUpdate = false) {\n    if (typeof partialState !== 'object') {\n      throw new Error('takes an object of state variables to update')\n    }\n\n    Object.keys(partialState).forEach(\n      (key) => (this.state[key] = partialState[key]),\n    )\n    if (!beforeUpdate) {\n      this.queuedUpdate()\n    }\n  }\n\n  injectObject() {\n    let p: ExtendedElement = this.parentNode as ExtendedElement\n    // @ts-ignore deprecated\n    while (p && !this.store && !options.mixin.store) {\n      // @ts-ignore deprecated\n      this.store = p.store\n      p = (p.parentNode || p.host) as ExtendedElement\n    }\n\n    if (this.inject) {\n      this.injection = {}\n      p = this.parentNode as ExtendedElement\n      let provide: unknown\n      while (p && !provide) {\n        provide = p.provide\n        p = (p.parentNode || p.host) as ExtendedElement\n      }\n      if (provide) {\n        this.inject.forEach((injectKey) => {\n          // @ts-ignore\n          this.injection[injectKey] = provide[injectKey]\n        })\n      }\n    }\n\n    for (const key in options.mixin) {\n      if (!this.hasOwnProperty(key)) {\n        Object.defineProperty(this, key, {\n          get: () => {\n            return options.mixin[key]\n          },\n        })\n      }\n    }\n  }\n\n  createRenderRoot(): ShadowRoot | Component {\n    if ((this.constructor as typeof Component).isLightDOM) {\n      return this\n    } else {\n      if (this.shadowRoot) {\n        let fc: ChildNode | null\n        while ((fc = this.shadowRoot.firstChild)) {\n          this.shadowRoot.removeChild(fc)\n        }\n        return this.shadowRoot\n      } else {\n        return this.attachShadow({\n          mode: 'open',\n          // delegatesFocus: true,\n        })\n      }\n    }\n  }\n\n  applyAdoptedStyleSheets() {\n    if (\n      !(this.constructor as typeof Component).isLightDOM &&\n      !adoptedStyleSheetsMap.has(this.constructor)\n    ) {\n      const css = (this.constructor as typeof Component).css\n      if (css) {\n        let styleSheets: CSSStyleSheet[] = []\n        if (typeof css === 'string') {\n          styleSheets = [createStyleSheet(css)]\n        } else if (isArray(css)) {\n          styleSheets = (css as Module[]).map((styleSheet) => {\n            if (typeof styleSheet === 'string') {\n              return createStyleSheet(styleSheet)\n            } else if (\n              (styleSheet as Module).default &&\n              typeof (styleSheet as Module).default === 'string'\n            ) {\n              return createStyleSheet((styleSheet as Module).default)\n            } else {\n              return styleSheet\n            }\n          }) as CSSStyleSheet[]\n        } else if (\n          (css as Module).default &&\n          typeof (css as Module).default === 'string'\n        ) {\n          styleSheets = [createStyleSheet((css as Module).default)]\n        } else {\n          styleSheets = [css as unknown as CSSStyleSheet]\n        }\n\n        // add globalCSS\n        styleSheets = [...options.globalCSS, ...styleSheets]\n          ;(this.renderRoot as ShadowRoot).adoptedStyleSheets = styleSheets\n        adoptedStyleSheetsMap.set(this.constructor, styleSheets)\n      } else {\n        if (options.globalCSS.length) {\n          ;(this.renderRoot as ShadowRoot).adoptedStyleSheets =\n            options.globalCSS\n        }\n      }\n    } else {\n      ;(this.renderRoot as ShadowRoot).adoptedStyleSheets =\n        adoptedStyleSheetsMap.get(this.constructor)\n    }\n  }\n\n  appendStyleVNode(rendered: VNode | VNode[]) {\n    if (this.props.css && rendered) {\n      const styleVNode = {\n        nodeName: 'style',\n        attributes: {},\n        children: [this.props.css],\n      }\n      return isArray(rendered) ? [...rendered, styleVNode] : [rendered, styleVNode]\n    }\n    return rendered\n  }\n\n  connectedCallback(): void {\n    this.injectObject()\n    this.attrsToProps()\n    this.install()\n    this.fire('install', this)\n    this.renderRoot = this.createRenderRoot()\n    this.applyAdoptedStyleSheets()\n    setActiveComponent(this)\n    this.beforeRender()\n    this.fire('beforeRender', this)\n    // @ts-ignore\n    const rendered = this.appendStyleVNode(this.render(this.props, this.store))\n    this.rendered(rendered)\n    clearActiveComponent()\n    this.rootElement = diff(null, rendered as VNode, null, this, false)\n\n    if (isArray(this.rootElement)) {\n      ;(this.rootElement as Element[]).forEach((item) => {\n        this.renderRoot?.appendChild(item)\n      })\n    } else {\n      this.rootElement &&\n        this.renderRoot?.appendChild(this.rootElement as Element)\n    }\n    this.installed()\n    this.fire('installed', this)\n    this.isInstalled = true\n\n    Promise.resolve().then(() => {\n      this.ready()\n      this.fire('ready', this)\n    })\n\n    this.executeHooks('connected')\n  }\n\n  disconnectedCallback(): void {\n    this.uninstall()\n    this.fire('uninstall', this)\n    this.isInstalled = false\n    this.executeHooks('disconnected')\n  }\n\n  update(updateSelf?: boolean): void {\n    this.beforeUpdate()\n    this.fire('beforeUpdate', this)\n    this.attrsToProps()\n    setActiveComponent(this)\n    this.beforeRender()\n    this.fire('beforeRender', this)\n    // @ts-ignore\n    const rendered = this.appendStyleVNode(this.render(this.props, this.store))\n    this.rendered(rendered)\n    clearActiveComponent(null)\n\n    this.rootElement = diff(\n      this.rootElement,\n      rendered as VNode,\n      this.renderRoot as ExtendedElement,\n      this,\n      !!updateSelf,\n    )\n    this.updated()\n    this.fire('updated', this)\n  }\n\n  private updateQueued = false\n\n  queuedUpdate(): void {\n    if (!this.updateQueued) {\n      this.updateQueued = true\n      Promise.resolve().then(() => {\n        this.update()\n        this.updateQueued = false\n      })\n    }\n  }\n\n  updateProps(obj: Record<string, unknown>): void {\n    Object.keys(obj).forEach((key) => {\n      this.props[key] = obj[key]\n      if (this.prevProps) {\n        this.prevProps[key] = obj[key]\n      }\n    })\n    this.update()\n  }\n\n  updateSelf(): void {\n    this.update(true)\n  }\n\n  removeProp(key: string): void {\n    this.removeAttribute(key)\n    // Avoid executing removeAttribute methods before connectedCallback\n    this.isInstalled && this.update()\n  }\n\n  setProp(key: string, val: string | object): void {\n    if (val && typeof val === 'object') {\n      this.setAttribute(key, JSON.stringify(val))\n    } else {\n      this.setAttribute(key, val)\n    }\n    // Avoid executing setAttribute methods before connectedCallback\n    this.isInstalled && this.update()\n  }\n\n  attrsToProps(): void {\n    if (this.props.ignoreAttrs) return\n    const ele = this\n    const constructor = this.constructor as typeof Component\n    ele.props['css'] = ele.getAttribute('css')\n    const attrs = constructor.propTypes\n    if (!attrs) return\n    Object.keys(attrs).forEach((key) => {\n      if (constructor.isComplexType(key)) return\n\n      const val = ele.getAttribute(hyphenate(key))\n      if (val !== null) {\n        ele.props[key] = this.getTypeValueOfProp(key, val)\n      } else {\n        if (\n          constructor.defaultProps &&\n          constructor.defaultProps.hasOwnProperty(key)\n        ) {\n          ele.props[key] = constructor.defaultProps[\n            key\n          ]\n        } else {\n          ele.props[key] = null\n        }\n      }\n    })\n  }\n\n  getTypeValueOfProp(key: string, val: string) {\n    const attrs = (this.constructor as typeof Component).propTypes\n    const types = isArray(attrs[key]) ? attrs[key] : [attrs[key]]\n\n    for (let i = 0; i < (types as Array<PropType>).length; i++) {\n      const type = (types as Array<PropType>)[i]\n      switch (type) {\n        case String:\n          return val\n        case Number:\n          return Number(val)\n        case Boolean:\n          return Boolean(val !== 'false' && val !== '0')\n        case Array:\n        case Object:\n          try {\n            return JSON.parse(val)\n          } catch (e) {\n            console.warn(\n              `The ${key} object prop does not comply with the JSON specification, the incorrect string is [${val}].`,\n            )\n          }\n      }\n    }\n  }\n\n  fire(\n    name: string,\n    data: unknown,\n    options?: { bubbles: boolean; composed: boolean },\n  ): void {\n    const { bubbles, composed } = Object.assign(\n      { bubbles: false, composed: false },\n      options,\n    )\n    const handler = this.props[`on${capitalize(name)}`] as Function\n    if (handler) {\n      handler(\n        new CustomEvent(name, {\n          detail: data,\n          bubbles,\n          composed,\n        }),\n      )\n    } else {\n      this.dispatchEvent(\n        new CustomEvent(name, {\n          detail: data,\n          bubbles,\n          composed,\n        }),\n      )\n    }\n  }\n\n  install() { }\n\n  installed() { }\n\n  ready() { }\n\n  uninstall() { }\n\n  beforeUpdate() { }\n\n  updated() { }\n\n  beforeRender() {\n    // 针对非omi环境使用children的情况\n    if (!this.props.children) {\n      this.props.children = convertNodeListToVNodes.call(this, this.childNodes)\n    }\n  }\n\n  rendered(vnode: VNode | VNode[]) { }\n\n  receiveProps() { }\n}\n\nexport class FormAssociatedComponent extends Component {\n  static formAssociated: boolean = false\n  _form: HTMLFormElement | null = null // 引用表单元素\n  _inputs: HTMLInputElement[] = [] // 引用表单元素内部的 input 元素\n  _internals: ElementInternals | null = null // 表单元素内部对象\n  formAssociatedCallback(form: HTMLFormElement) { } // 当组件被添加到表单元素内部时调用\n  handleFormData(event: FormDataEvent) { } // 处理表单数据事件\n  getFieldValue(): Record<string, any> { } // 返回获取 input 元素的值\n  resetFieldValue(): void // 当重新表单时调用\n  handleField(event: Event) { } // 处理 input 事件\n  formDisabledCallback() { } // 当表单元素被禁用时调用\n  formResetCallback() { } // 当表单元素被重置时调用\n  formStateRestoreCallback(state: any, mode: any) { } // 当表单元素状态被恢复时调用\n}\n","import { diff } from './diff'\nimport { ExtendedElement } from './dom'\nimport { VNode } from './vdom'\n\nexport function render(\n  vnode: unknown,\n  parent: Element | null | string,\n  store?: unknown,\n) {\n  parent = typeof parent === 'string' ? document.querySelector(parent) : parent\n  if (store && parent) {\n    ;(parent as ExtendedElement).store = store\n  }\n  return diff(null, vnode as VNode, parent as ExtendedElement, null, false)\n}\n","/**\n * classNames based on https://github.com/JedWatson/classnames\n * by Jed Watson\n * Licensed under the MIT License\n * https://github.com/JedWatson/classnames/blob/master/LICENSE\n * modified by dntzhang\n */\nconst hasOwn = {}.hasOwnProperty\n\ntype Value = string | number | boolean | undefined | null\ntype Mapping = Record<string, unknown>\ninterface ArgumentArray extends Array<Argument> {}\ninterface ReadonlyArgumentArray extends ReadonlyArray<Argument> {}\ntype Argument = Value | Mapping | ArgumentArray | ReadonlyArgumentArray\n\nexport function classNames(...args: ArgumentArray): string {\n  const classes: (string | number)[] = []\n\n  for (let i = 0; i < args.length; i++) {\n    const arg: Argument = args[i]\n    if (!arg) continue\n\n    const argType = typeof arg\n\n    if (argType === 'string' || argType === 'number') {\n      classes.push(arg as string | number)\n    } else if (Array.isArray(arg) && arg.length) {\n      const inner = classNames(...arg)\n      if (inner) {\n        classes.push(inner)\n      }\n    } else if (argType === 'object') {\n      for (const key in arg as Mapping) {\n        if (hasOwn.call(arg, key) && (arg as Mapping)[key]) {\n          classes.push(key)\n        }\n      }\n    }\n  }\n\n  return classes.join(' ')\n}\n\ntype PropsMapping = {\n  class?: Argument\n  className?: Argument\n} & Mapping\n\nexport function extractClass(\n  props: PropsMapping,\n  ...args: ArgumentArray\n): { class: string } | undefined {\n  if (props.class) {\n    args.unshift(props.class)\n    delete props.class\n  } else if (props.className) {\n    args.unshift(props.className)\n    delete props.className\n  }\n  if (args.length > 0) {\n    return { class: classNames(...args) }\n  }\n}\n","/**\n * Cache for storing created CSSStyleSheets.\n */\nlet styleSheetCache: { [key: string]: CSSStyleSheet } = {}\n\n/**\n * A tagged template function for CSS that supports JavaScript expressions.\n * It concatenates the parts of the template string with the values of the expressions.\n * It also checks if the values are safe to insert into CSS.\n * The function returns a CSSStyleSheet object, which can be shared among multiple elements.\n *\n * @param {TemplateStringsArray} strings - The parts of the template string.\n * @param {...unknown[]} values - The values of the expressions.\n * @returns {CSSStyleSheet} The resulting CSSStyleSheet object.\n * @throws {Error} If a value is not safe to insert into CSS.\n */\nexport function css(\n  strings: TemplateStringsArray,\n  ...values: unknown[]\n): CSSStyleSheet {\n  let str = ''\n  strings.forEach((string, i) => {\n    // Check if the value is safe to insert into CSS\n    if (\n      values[i] !== undefined &&\n      typeof values[i] !== 'string' &&\n      typeof values[i] !== 'number'\n    ) {\n      throw new Error(`Unsupported value in CSS: ${values[i]}`)\n    }\n\n    str += string + (values[i] || '')\n  })\n\n  // Check if the style sheet is in the cache\n  if (styleSheetCache[str]) {\n    // If it is, return the cached style sheet\n    return styleSheetCache[str]\n  } else {\n    // If it's not, create a new style sheet\n    const styleSheet = new CSSStyleSheet()\n    styleSheet.replaceSync(str)\n\n    // Store the new style sheet in the cache\n    styleSheetCache[str] = styleSheet\n\n    // Return the new style sheet\n    return styleSheet\n  }\n}\n","export { cloneElement, createElement, createElement as h } from './vdom'\nexport {\n  Component,\n  Component as WeElement,\n  FormAssociatedComponent,\n} from './component'\nexport { render } from './render'\nexport { define, define as defineElement, tag, webcomponent } from './define'\nexport { classNames, extractClass } from './class'\nexport { createRef, bind } from './utils'\nexport {\n  signal,\n  computed,\n  effect,\n  batch,\n  setActiveComponent,\n  clearActiveComponent,\n  getActiveComponent,\n  signalObject,\n} from 'reactive-signal'\nexport type { Signal, SignalObject, Signal as SignalValue } from 'reactive-signal'\nexport { css } from './css-tag'\nexport { mixin, globalCSS } from './options'\nexport { registerDirective } from './directive'\nexport const version = '7.7.13'\n"],"names":["camelCase","str","replace","_","$1","toUpperCase","Fragment","props","children","applyRef","ref","value","current","isArray","obj","Object","prototype","toString","call","document","hasShadyCss","window","ShadyCSS","nativeShadow","bootstrapper","implementation","createHTMLDocument","closedShadowRootRegistry","WeakMap","_DOMException","DOMException","Error","defineProperty","forEach","Array","importPattern","nonConstructedProto","CSSStyleSheet","Promise","reject","replaceSync","$basicStyleSheet","$locations","$adoptersByLocation","proto$2","ConstructedStyleSheet","contents","this","resolve","e","checkInvocationCorrectness","self_1","style","get","ownerNode","textContent","_contents","console","warn","trim","rejectImports","set","sheet","location","isConnected","restyleAdopter","getAdopterByLocation","configurable","enumerable","cssRules","method","self","args","arguments","basic","locations","result","apply","Symbol","hasInstance","isCSSStyleSheetInstance","defaultObserverOptions","childList","subtree","$element","$uniqueSheets","$observer","proto$1","Location","element","Document","readyState","contains","isElementConnected","host","connect","container","getAdopterContainer","observe","length","adopt","traverseWebComponents","root","getAssociatedLocation","disconnect","update","sheets","locationType","TypeError","every","some","isNonConstructedStyleSheetInstance","arr","arr2","oldUniqueSheets","uniqueSheets","filter","index","indexOf","node","parentNode","removeChild","delete","_location","removeAdopterLocation","attachAdoptedStyleSheetProperty","ShadowRoot","proto","Element","attach_1","attachShadow","init","mode","documentLocation","addEventListener","bind","getShadowRoot","shadowRoot","instance","isPrototypeOf","adopter","requestAnimationFrame","from","to","i","deleteRule","clearRules","rule","insertRule","cssText","has","createElement","body","appendChild","constructor","callback","iter","createNodeIterator","NodeFilter","SHOW_ELEMENT","foundNode","FILTER_ACCEPT","FILTER_REJECT","next","nextNode","styleList","createDocumentFragment","observer","push","addAdopterLocation","insertBefore","MutationObserver","mutations","mutation","addedNodes","removedNodes","HTMLStyleElement","isExistingAdopter","w","global","undefined","Reflect","customElements","hasOwnProperty","BuiltInHTMLElement","HTMLElement","construct","setPrototypeOf","hyphenateRE","hyphenate","toLowerCase","createStyleSheet","styleSheet","isNamedNode","nodeName","normalizedNodeName","createRef","target","propertyKey","descriptor","bound","writable","isObject","item","isClass","cls","test","getClassStaticValue","instanceOrClass","fieldName","options","opts","assign","merge","default","fieldValue","valueType","defaultValue","values","__proto__","mergedResult","reduce","Set","installHook","hooks","entries","key","hook","convertNodeListToVNodes","childNodes","map","nodeType","Node","TEXT_NODE","ELEMENT_NODE","attributes","ignoreAttrs","attr","name","tagName","Boolean","restChildren","flat","cloneElement","vnode","_extends","depth","flatten","level","f","DOM_EVENT_MAP","onanimationcancel","oncompositionend","oncompositionstart","oncompositionupdate","onfocusin","onfocusout","onscrollend","ontouchcancel","ontouchend","ontouchmove","ontouchstart","IS_NON_DIMENSIONAL","directives","registerDirective","handler","removeNode","setAccessor","old","isSvg","then","_directives$name","setStyle","innerHTML","html","useCapture","nameLower","slice","eventProxy","removeEventListener","_listeners","bindEvent","removeAttribute","ns","removeAttributeNS","setAttributeNS","is","_node$constructor$ref","reflect","reflectProps","setAttribute","className","type","setProperty","diffLevel","isSvgMode","isForeignObject","hydrating","diff","dom","parent","component","updateSelf","ret","_ret","isLightDOM","ownerSVGElement","innerDiffNode","ele","idiff","NodeList","child","recollectNodeTree","out","prevSvgMode","prevForeignObject","_dom$parentNode","splitText","_component","nodeValue","String","createTextNode","replaceChild","prevProps","vnodeName","_out$constructor","createElementNS","createNode","_dom$parentNode2","firstChild","fc","vchildren","a","nextSibling","noSlot","unsafeHTML","attrs","oldClone","isComponent","receiveProps","defaultProps","propName","_props$propName","ccName","queuedUpdate","diffAttributes","isHydrating","j","c","vchild","originalChildren","keyed","keyedLen","min","len","childrenLen","vlen","_child$nodeValue","unmountOnly","_node","lastChild","previousSibling","removeChildren","mixin","globalCSS","css","includes","formAssociatedHook","define","formAssociatedCallback","form","_form","handleFormData","initial","getFieldValue","_self$shadowRoot","_inputs","querySelectorAll","input","resetFieldValue","_self$shadowRoot2","formData","append","_internals","attachInternals","connected","ctor","tag","formAssociated","hookName","hookRegistry","_hooks","executeComponentHooks","webcomponent","forwardRef","_ref","Proxy","receiver","fire","bubbles","composed","_onRefAttached","detail","disconnected","id","adoptedStyleSheetsMap","Component","super","elementId","isInstalled","inject","injection","renderRoot","rootElement","state","updateQueued","handleProps","executeHooks","propTypes","prop","handleComplexProps","keys","isComplexType","useDOMProperty","t","observedAttributes","p","attributeChangedCallback","oldValue","newValue","changed","newTypeValue","getTypeValueOfProp","oldTypeValue","setState","partialState","beforeUpdate","injectObject","store","provide","injectKey","createRenderRoot","applyAdoptedStyleSheets","adoptedStyleSheets","styleSheets","appendStyleVNode","rendered","styleVNode","connectedCallback","attrsToProps","install","setActiveComponent","beforeRender","render","_this$renderRoot2","clearActiveComponent","_this$renderRoot","installed","ready","disconnectedCallback","uninstall","updated","updateProps","removeProp","setProp","val","JSON","stringify","getAttribute","types","Number","parse","data","letter","s","capitalize","CustomEvent","dispatchEvent","h","FormAssociatedComponent","event","handleField","formDisabledCallback","formResetCallback","formStateRestoreCallback","querySelector","hasOwn","classNames","classes","arg","argType","inner","join","extractClass","class","unshift","styleSheetCache","strings","string","version"],"mappings":"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"}