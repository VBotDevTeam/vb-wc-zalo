var d=Object.defineProperty;var h=(e,t,s)=>t in e?d(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var n=(e,t,s)=>(h(e,typeof t!="symbol"?t+"":t,s),s);(function(e,t){typeof exports=="object"&&typeof module<"u"?t(require("omi")):typeof define=="function"&&define.amd?define(["omi"],t):(e=typeof globalThis<"u"?globalThis:e||self,t(e.Omi))})(this,function(e){var t;"use strict";e.define("o-suspense",(t=class extends e.Component{constructor(){super(...arguments);n(this,"state","pending");n(this,"timeout",null)}install(){this.handleTasks(this.props.imports)}receiveProps(){this.state="pending",this.handleTasks(this.props.imports)}async handleTasks(l){this.timeout!==null&&clearTimeout(this.timeout);let r=Date.now();const a=[...l];if(this.props.data&&a.push(this.props.data()),a.length===0)this.state="pending";else{this.fire("pending");try{const i=await Promise.all(a);let o=Date.now()-r;o<this.props.minLoadingTime?this.timeout=setTimeout(()=>{this.state="resolve",this.fire("resolve"),this.fire("data-loaded",i.pop()),this.update()},this.props.minLoadingTime-o):(this.state="resolve",this.fire("resolve"),this.fire("data-loaded",i.pop()))}catch(i){console.error(i),this.state="fallback",this.fire("fallback")}}this.update()}render(){return this.state==="pending"?e.h("slot",{name:"pending"}):this.state==="resolve"?e.h("slot",null):e.h("slot",{name:"fallback"})}},n(t,"defaultProps",{imports:[],data:null,minLoadingTime:0}),t))});
