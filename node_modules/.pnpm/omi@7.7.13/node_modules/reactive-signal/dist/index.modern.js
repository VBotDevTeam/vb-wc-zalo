let e=null,s=!1,t=new Set,i=null;function n(e,s){i=e,i._tempActiveUpdateFnName=s||"queuedUpdate"}function c(){i=null}function u(){return i}class r{constructor(e){this._value=void 0,this.subscribers=new Set,this.depsComponents=new Set,this.notifying=!1,this._value=e}get value(){this.notifying||e&&(e.run&&this.subscribe(e.run),e.addDependency(this));const s=u();return s&&this.depsComponents.add(s),this._value}set value(e){e!==this._value&&(this._value=e,this.update())}peek(){return this._value}update(){this.notify(),this.depsComponents.forEach(e=>{var s;return null==(s=e[e._tempActiveUpdateFnName])?void 0:s.call(e)}),this.subscribers.forEach(e=>{e.computedInstance&&e.computedInstance.subscribers.forEach(e=>{e.done=!1}),e.done=!1})}subscribe(e){this.subscribers.add(e)}unsubscribe(e){this.subscribers.delete(e)}notify(){s?this.subscribers.forEach(e=>t.add(e)):(this.notifying=!0,this.subscribers.forEach(e=>{"function"!=typeof e||e.done||(e.done=!0,e())}),this.notifying=!1)}}class o{constructor(e){this.computeFn=void 0,this._value=void 0,this.dependencies=new Set,this.subscribers=new Set,this.depsComponents=new Set,this.notifying=!1,this.recompute=()=>{const e=this.compute();e!==this._value&&(this._value=e,this.notify(),this.depsComponents.forEach(e=>{var s;return null==(s=e[e._tempActiveUpdateFnName])?void 0:s.call(e)}))},this.computeFn=e,this._value=this.compute()}get value(){this.notifying||e&&(this.subscribe(e.run),e.addDependency(this));const s=u();return s&&this.depsComponents.add(s),this._value}peek(){return this._value}compute(){const s=e;e=this;const t=this.computeFn();return e=s,t}subscribe(e){e&&this.subscribers.add(e)}unsubscribe(e){this.subscribers.delete(e)}notify(){s?this.subscribers.forEach(e=>t.add(e)):(this.notifying=!0,this.subscribers.forEach(e=>{e.done||(e.done=!0,e())}),this.notifying=!1)}addDependency(e){this.dependencies.add(e),e.subscribe(this.recompute),this.recompute.computedInstance=this}}class h{constructor(s){this.effectFn=void 0,this.dependencies=new Set,this.disposed=!1,this.run=()=>{if(this.disposed)return;const s=e;e=this,this.effectFn(),e=s},this.effectFn=s,this.run()}addDependency(e){this.disposed||(this.dependencies.add(e),this.run.effectInstance=this,e.subscribe(this.run))}cleanup(){this.dependencies.forEach(e=>e.unsubscribe(this.run)),this.dependencies.clear()}dispose(){this.cleanup(),this.disposed=!0}}function d(e){return new r(e)}function a(e){return new o(e)}function p(e){const s=new h(e);return()=>s.dispose()}function b(e){s=!0;try{e()}finally{s=!1,t.forEach(e=>{e.done||(e.done=!0,e())}),t.forEach(e=>{e.done=!1}),t.clear()}}function f(e){return Object.entries(e).reduce((e,[s,t])=>(e[s]=d(t),e),{})}export{b as batch,c as clearActiveComponent,a as computed,p as effect,u as getActiveComponent,n as setActiveComponent,d as signal,f as signalObject};
//# sourceMappingURL=index.modern.js.map
