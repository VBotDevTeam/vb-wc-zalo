function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,"symbol"==typeof(s=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(i.key))?s:String(s),i)}var s}function t(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}var n=null,i=!1,s=new Set,r=null;function o(){return r}var u=/*#__PURE__*/function(){function e(e){this._value=void 0,this.subscribers=new Set,this.depsComponents=new Set,this.notifying=!1,this._value=e}var r=e.prototype;return r.peek=function(){return this._value},r.update=function(){this.notify(),this.depsComponents.forEach(function(e){var t;return null==(t=e[e._tempActiveUpdateFnName])?void 0:t.call(e)}),this.subscribers.forEach(function(e){e.computedInstance&&e.computedInstance.subscribers.forEach(function(e){e.done=!1}),e.done=!1})},r.subscribe=function(e){this.subscribers.add(e)},r.unsubscribe=function(e){this.subscribers.delete(e)},r.notify=function(){i?this.subscribers.forEach(function(e){return s.add(e)}):(this.notifying=!0,this.subscribers.forEach(function(e){"function"!=typeof e||e.done||(e.done=!0,e())}),this.notifying=!1)},t(e,[{key:"value",get:function(){this.notifying||n&&(n.run&&this.subscribe(n.run),n.addDependency(this));var e=o();return e&&this.depsComponents.add(e),this._value},set:function(e){e!==this._value&&(this._value=e,this.update())}}]),e}(),c=/*#__PURE__*/function(){function e(e){var t=this;this.computeFn=void 0,this._value=void 0,this.dependencies=new Set,this.subscribers=new Set,this.depsComponents=new Set,this.notifying=!1,this.recompute=function(){var e=t.compute();e!==t._value&&(t._value=e,t.notify(),t.depsComponents.forEach(function(e){var t;return null==(t=e[e._tempActiveUpdateFnName])?void 0:t.call(e)}))},this.computeFn=e,this._value=this.compute()}var r=e.prototype;return r.peek=function(){return this._value},r.compute=function(){var e=n;n=this;var t=this.computeFn();return n=e,t},r.subscribe=function(e){e&&this.subscribers.add(e)},r.unsubscribe=function(e){this.subscribers.delete(e)},r.notify=function(){i?this.subscribers.forEach(function(e){return s.add(e)}):(this.notifying=!0,this.subscribers.forEach(function(e){e.done||(e.done=!0,e())}),this.notifying=!1)},r.addDependency=function(e){this.dependencies.add(e),e.subscribe(this.recompute),this.recompute.computedInstance=this},t(e,[{key:"value",get:function(){this.notifying||n&&(this.subscribe(n.run),n.addDependency(this));var e=o();return e&&this.depsComponents.add(e),this._value}}]),e}(),f=/*#__PURE__*/function(){function e(e){var t=this;this.effectFn=void 0,this.dependencies=new Set,this.disposed=!1,this.run=function(){if(!t.disposed){var e=n;n=t,t.effectFn(),n=e}},this.effectFn=e,this.run()}var t=e.prototype;return t.addDependency=function(e){this.disposed||(this.dependencies.add(e),this.run.effectInstance=this,e.subscribe(this.run))},t.cleanup=function(){var e=this;this.dependencies.forEach(function(t){return t.unsubscribe(e.run)}),this.dependencies.clear()},t.dispose=function(){this.cleanup(),this.disposed=!0},e}();function a(e){return new u(e)}exports.batch=function(e){i=!0;try{e()}finally{i=!1,s.forEach(function(e){e.done||(e.done=!0,e())}),s.forEach(function(e){e.done=!1}),s.clear()}},exports.clearActiveComponent=function(){r=null},exports.computed=function(e){return new c(e)},exports.effect=function(e){var t=new f(e);return function(){return t.dispose()}},exports.getActiveComponent=o,exports.setActiveComponent=function(e,t){(r=e)._tempActiveUpdateFnName=t||"queuedUpdate"},exports.signal=a,exports.signalObject=function(e){return Object.entries(e).reduce(function(e,t){return e[t[0]]=a(t[1]),e},{})};
//# sourceMappingURL=index.cjs.map
